# Gemini CLI Session Context

## Project

- **Frontend:** `manga-toread-frontend` (React.js with TypeScript)
- **Backend:** `manga-toread-api-typescript` (TypeScript, Fastify, Prisma, MongoDB)

## What has been done

- Created the `manga-toread-frontend` directory.
- Initialized a new React application using `create-react-app` with the TypeScript template.
- Installed `axios` and `react-router-dom`.
- Created the basic folder structure for the application (`components`, `pages`, `services`, `hooks`, `contexts`, `utils`).
- Created the authentication service (`src/services/auth.ts`).
- Created the `AuthContext` to manage the user's authentication state (`src/contexts/AuthContext.tsx`).
- Created the main application component, `App.tsx`, with routing.
- Created the `PrivateRoute` component.
- Created the `LoginPage`, `RegisterPage`, and `DashboardPage`.
- Updated the `index.tsx` file to render the `App` component.
- Started the development server.
- Fixed a TypeScript configuration issue related to JSX.
- Displayed a message when no manhwas are found after a search.
- Adjusted navigation flow for login, registration, and root path.
- Fixed authentication state re-hydration on page load.
- Implemented automatic redirection from login page for authenticated users.
- Added a loading effect to the dashboard.
- Improved UI for profile update feedback using Snackbar.
- Adjusted Snackbar position to top-center for better visibility.
- Implemented global 401 Unauthorized error handling to redirect to login page.
- Fixed `useNavigate` hook usage by creating a `NavigationSetter` component.
- Implemented the UI for the `LoginPage` and `RegisterPage` with a modern design using Material-UI.
- Beautified the dashboard home to improve UI/UX for showing the manhwas list.
- Implemented the functionality to display a list of manhwas on the dashboard.
- Implemented the functionality for users to add, remove, and update their manhwas.
- Implemented the user profile page.
- Added a proper styling solution (e.g., Material-UI or Bootstrap).
- **Fixed Bug:** Manhwa list does not update automatically after adding a new manhwa.
- Added confirmation dialog for removing manhwa.
- Improved Telegram notification toggle to update UI optimistically and then with backend response.
- Fixed Telegram notification toggle state on refresh by including `isTelegramNotificationEnabled` in backend response.
- Fixed 500 error on Telegram linking reset by setting `Content-Type` header to `application/json`.
- Improved Telegram linking instructions on frontend.
- Implemented frontend update of Telegram linking status and conditional button display.
- Fixed `useCallback` import in `AuthContext.tsx`.
- Fixed backend `profile` controller to return `telegramId` and `telegramActive`.
- Improved frontend error message for enabling Telegram notifications without linking.
- Adjusted Snackbar position to top-center in `ProfilePage.tsx`.
- Implemented backend route for updating user manhwa (last episode read, provider, status).
- Implemented new UI/UX for adding a new manhwa with a dedicated modal for provider and initial details selection.
- Fixed `@prisma/client` import in `AddManhwaModal.tsx`.
- Enhanced `AddManhwaModal` UI to show manhwa cover and last episode released for each provider.
- Enhanced `ManhwaSearch` UI to show manhwa cover and improve layout in search results.
- Improved UI/UX for adding existing manhwa by displaying a Snackbar message.
- Disabled CORS in the backend to allow access from mobile devices.
- Added a workaround for `window.ethereum` error on mobile by defining it in `public/index.html`.
- Implemented Google SSO login in the frontend.
- Configured Google Client ID to be read from environment variables.
- Fixed incorrect `providerId` being sent when adding a new manhwa.
- Fixed display of "New Episode Available!" when `lastEpisodeRead` is 0.
- Fixed payload names for updating user manhwa in `UpdateManhwaModal.tsx`.
- Fixed `providerId` selection and update in `UpdateManhwaModal.tsx`.
- Added "Clear Search" button to `ManhwaSearch.tsx`.
- Configured `refreshToken` cookie domain to `null` in backend for cross-device access.
- Configured `API_URL` to be read from environment variables in frontend services.
- Fixed TypeScript errors in backend (`fastifyJwt` cookie config and missing imports).
- Implemented pagination for user's manhwa list on the dashboard.
- Configured `pageSize` to be read from environment variables in `DashboardPage.tsx`.
- Implemented pagination for manhwa search results.
- Configured search results `pageSize` to be read from environment variables in `ManhwaSearch.tsx`.
- Fixed TypeScript error in `filter-manhwa.ts` by correcting destructuring and response.
- Implemented admin page and route protection, and conditionally displayed the "Admin" link in the navigation.
- Implemented backend for deleting manhwas and providers.
- Implemented basic admin page structure with Manhwa and Provider management tabs.
- Created `admin.ts` service for admin-specific API calls and updated `ManhwaManagement.tsx` and `ProviderManagement.tsx` to use it.
- Fixed `useCallback` import warnings in `ManhwaManagement.tsx` and `ProviderManagement.tsx`.
- Fixed `setPageSize` unused variable warnings in `ManhwaSearch.tsx` and `DashboardPage.tsx`.
- Fixed `ProviderManagement.tsx` `useEffect` dependency warning.
- Fixed `ManhwasRepository` interface and `InMemoryManhwasRepository` implementation to include `delete` method.
- Fixed typo in `delete-provider.ts` (`findByID` to `findById`).
- Updated `get-providers.spec.ts` to pass `searchTerm` to `execute` method.
- Fixed syntax error in `ManhwaManagement.tsx` (`map` function JSX return`).
- Fixed `ManhwaManagement.tsx` to correctly display manhwa list by adjusting interfaces and rendering logic.
- Enhanced `/manhwa/list` endpoint to return more details (author, genre, description, status) and updated frontend to display them.
- Fixed TypeScript errors in `InMemoryManhwasRepository` and `PrismaManhwasRepository` related to `filterByName` and `genre` filtering.
- Implemented backend route and service for fetching a single manhwa by ID.
- Updated `ManhwaManagement.tsx` to fetch full manhwa details when editing.
- Beautified `ManhwaManagement` UI to show cover, genres, and status in the list, and added status select to dialog.
- Fixed missing Material-UI imports in `ManhwaManagement.tsx`.
- Beautified `ManhwaManagement` UI to show genre and status as chips.
- Enhanced `ManhwaManagement` UI to show genre and status with titles and ensure genre tags wrap to the next line.
- Improved `ManhwaManagement` UI to align genre and status titles with chips and make titles more prominent.
- Added vertical spacing between rows of genre tags in `ManhwaManagement` for better readability.
- Aligned genre titles with tags and prevented tag overlap with action icons in `ManhwaManagement`.
- Enhanced `ManhwaManagement` UI to give manhwa titles a more prominent, spotlight position.
- Improved cover image presentation in `ManhwaManagement` with larger size, shadow, and proper scaling.
- Implemented pagination in `ManhwaManagement` with a configurable page size.
- Enhanced the "Edit Manhwa" dialog in `ManhwaManagement` with a dynamic genre tag field and a cover image preview.
- Fixed a React hydration error in `ManhwaManagement` caused by invalid DOM nesting.
- Improved genre parsing in `ManhwaManagement` to handle both JSON and comma-separated strings.
- Fixed a TypeScript error and an unused variable warning in `ManhwaManagement`.
- Made genre parsing in `ManhwaManagement` more robust to handle different data formats.
- Increased vertical spacing between genre tags in `ManhwaManagement` for better readability (specifically within the edit dialog).
- Fixed double-stringification of genre data in `ManhwaManagement` when updating manhwas.
- Implemented a Material-UI confirmation dialog for delete actions in `ManhwaManagement`.
- Added collapse/expand functionality for genre tags in `ManhwaManagement` to improve UI/UX.
- Refactored `ManhwaManagement` to use a new `ManhwaListItemWithGenre` component for better encapsulation of genre tag collapse/expand logic.
- Fixed layout and positioning of "Show More/Less" button and action icons in `ManhwaListItemWithGenre`.
- Removed unused imports from `ManhwaManagement.tsx`.
- Re-added missing `AddIcon` import to `ManhwaManagement.tsx`.
- Implemented `isActive` switch in `ProviderManagement.tsx` for creating/updating providers.
- Added missing Material-UI imports (`FormControlLabel`, `Switch`) to `ProviderManagement.tsx`.
- Implemented `ManhwaProviderManagement.tsx` component for assigning manhwas to providers.
- Added a new tab for "Manhwa-Provider Management" in `AdminPage.tsx`.
- Added `createManhwaProvider` function to `src/services/admin.ts` and corrected `createProvider` endpoint.
- Replaced `alert()` pop-ups with Material-UI `Snackbar` for user feedback in `ManhwaProviderManagement.tsx`.
- Implemented `ManhwaProviderList.tsx` component for displaying paginated and filterable manhwa-provider relationships.
- Added a new tab for "Manhwa-Provider List" in `AdminPage.tsx`.
- Removed unused `Button` import from `ManhwaProviderList.tsx`.
- Corrected the API endpoint for `getManhwaProviders` in `src/services/admin.ts`.
- Adjusted `ManhwaProviderList.tsx` to send `manhwaName` and `providerId` as filter parameters to the backend.
- Added missing React imports (`useState`, `useEffect`, `useCallback`) to `ManhwaProviderList.tsx`.
- Modified `ManhwaProviderList.tsx` to conditionally send `manhwaName` and `providerId` filter parameters to the backend.
- Removed `searchTerm` from the `params` object in `getManhwaProviders` in `src/services/admin.ts`.
- Corrected `getManhwaProviders` in `src/services/admin.ts` to conditionally include `manhwaName` and `providerId` in request parameters.
- Confirmed pagination is implemented in `ManhwaProviderList.tsx` with page size configurable via `REACT_APP_ADMIN_MANHWA_PROVIDER_PAGE_SIZE` environment variable.

## Next Steps

- [ ] Implement the Google SSO login flow.
- [ ] Add more detailed error handling and user feedback across the application.
- [ ] Implement admin functionalities (e.g., creating/updating manhwas from the frontend).

ALWAYS UPDATE THIS FILE FOR YOUR CONTEXT IN NEXT SESSIONS
